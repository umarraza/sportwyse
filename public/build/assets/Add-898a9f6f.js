import{o as m,e as f,a as s,k as x,H as b,t as _,n as g,F as V,i as k,r as P,f as S,P as E,Q as j,d as w,T as B,M as D,c as N,w as I,b as T,x as H,u as v,j as G,p as R,A as U,l as q}from"./app-8f30f156.js";import K from"./AppLayout-81deca66.js";import"./Banner-3d2772c1.js";import"./Sidebar-683ad1b0.js";import"./Header-8dd9c9cf.js";import"./DropdownLink-21f41d84.js";const h={openOptions(t){t.$refs.input.focus(),t.showMenu=!0,t.mousedownState=!1},blurInput(t){t.mousedownState||(t.searchText="",t.closeOptions()),t.$emit("blur")},closeOptions(t){t.$refs.input.blur(),t.showMenu=!1},prevItem(t){const e=t.pointer-1,d=t.$el.offsetHeight*e;e>=0&&(t.pointer=e),t.$refs.menu.scrollTop=d},nextItem(t){const e=t.pointer+1,d=t.$el.offsetHeight*e;e<=t.filteredOptions.length-1&&(t.pointer=e);const y=t.$refs.menu.offsetHeight,c=Math.ceil((t.$refs.menu.scrollTop+t.$el.offsetHeight)/y),o=Math.ceil(d/y);c!==o&&(t.$refs.menu.scrollTop=(o-1)*t.$refs.menu.offsetHeight)},enterItem(t){const e=t.filteredOptions[t.pointer],d=e.disabled;e&&!d&&t.selectItem(e)},pointerSet(t,e){t.pointer=e},pointerAdjust(t){t.pointer>=t.filteredOptions.length-1&&(t.pointer=t.filteredOptions.length?t.filteredOptions.length-1:0)},mousedownItem(t){t.mousedownState=!0}};function L(t){return new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i")}const z={props:{id:{default:null},name:{type:String,default:""},isError:{type:Boolean,default:!1},customAttr:{type:Function,default:()=>""},isDisabled:{type:Boolean,default:!1},placeholder:{type:String,default:""},filterPredicate:{type:Function,default:(t,e)=>t.match(L(e))}}},Q=(t,e)=>{const d=t.__vccOpts||t;for(const[y,c]of e)d[y]=c;return d},X={name:"ModelSelect",mixins:[z],emits:["blur","searchchange","update:modelValue"],props:{modelValue:{type:[String,Number,Object,Boolean]},customAttr:{type:Function,default:()=>""},options:{type:Array}},data(){return{showMenu:!1,searchText:"",mousedownState:!1,pointer:-1}},watch:{value(t){this.pointer=this.filteredOptions.findIndex(e=>e.value===this.optionValue(t))},filteredOptions(){this.pointerAdjust()},searchText(){this.$emit("searchchange",this.searchText)}},computed:{searchTextCustomAttr(){return this.selectedOption&&this.selectedOption.value?this.customAttr(this.selectedOption):""},inputText(){if(this.searchText)return"";{let t=this.placeholder;return this.selectedOption&&(t=this.selectedOption.text),t}},customAttrs(){try{if(Array.isArray(this.options))return this.options.map(t=>this.customAttr(t))}catch{}return[]},textClass(){return!this.selectedOption&&this.placeholder?"default":""},menuClass(){return{visible:this.showMenu,hidden:!this.showMenu}},menuStyle(){return{display:this.showMenu?"block":"none"}},filteredOptions(){return this.searchText?this.options.filter(t=>{try{return this.filterPredicate(t.text,this.searchText)}catch{return!0}}):this.options},selectedOption(){return this.options.find(t=>t.value===this.optionValue(this.modelValue))}},methods:{deleteTextOrItem(){!this.searchText&&this.modelValue&&(this.selectItem({}),this.openOptions())},openOptions(){h.openOptions(this)},blurInput(){h.blurInput(this)},closeOptions(){h.closeOptions(this)},prevItem(){h.prevItem(this)},nextItem(){h.nextItem(this)},enterItem(){h.enterItem(this)},pointerSet(t){h.pointerSet(this,t)},pointerAdjust(){h.pointerAdjust(this)},mousedownItem(){h.mousedownItem(this)},selectItem(t){this.searchText="",this.closeOptions(),typeof this.modelValue=="object"&&this.modelValue?this.$emit("update:modelValue",t):(this.$emit("update:modelValue",t.value),t.value!==void 0&&t.value===t.text&&(this.searchText=t.value))},optionValue(t){return typeof t=="object"&&t!==null?t.value:t}}},J=s("i",{class:"dropdown icon"},null,-1),W=["disabled","tabindex","id","name","value"],Y=["data-vss-custom-attr"],Z=["data-vss-custom-attr","onClick","onMouseenter"];function tt(t,e,d,y,c,o){return m(),f("div",{class:g(["ui fluid search selection dropdown",{"active visible":c.showMenu,error:t.isError,disabled:t.isDisabled}]),onClick:e[11]||(e[11]=(...n)=>o.openOptions&&o.openOptions(...n)),onFocus:e[12]||(e[12]=(...n)=>o.openOptions&&o.openOptions(...n))},[J,s("input",{class:"search",autocomplete:"off",disabled:t.isDisabled,tabindex:t.isDisabled?-1:0,id:t.id,name:t.name,value:c.searchText,onInput:e[0]||(e[0]=n=>c.searchText=n.target.value),ref:"input",onFocus:e[1]||(e[1]=x((...n)=>o.openOptions&&o.openOptions(...n),["prevent"])),onKeyup:[e[2]||(e[2]=b((...n)=>o.closeOptions&&o.closeOptions(...n),["esc"])),e[7]||(e[7]=b(x((...n)=>o.enterItem&&o.enterItem(...n),["prevent"]),["enter"]))],onBlur:e[3]||(e[3]=(...n)=>o.blurInput&&o.blurInput(...n)),onKeydown:[e[4]||(e[4]=b((...n)=>o.prevItem&&o.prevItem(...n),["up"])),e[5]||(e[5]=b((...n)=>o.nextItem&&o.nextItem(...n),["down"])),e[6]||(e[6]=b(x(()=>{},["prevent"]),["enter"])),e[8]||(e[8]=b((...n)=>o.deleteTextOrItem&&o.deleteTextOrItem(...n),["delete"]))]},null,40,W),s("div",{class:g(["text",o.textClass]),"data-vss-custom-attr":o.searchTextCustomAttr},_(o.inputText),11,Y),s("div",{class:g(["menu",o.menuClass]),ref:"menu",onMousedown:e[10]||(e[10]=x(()=>{},["prevent"])),style:E(o.menuStyle),tabindex:"-1"},[(m(!0),f(V,null,k(o.filteredOptions,(n,a)=>(m(),f("div",{key:a,class:g(["item",{selected:n.selected||c.pointer===a,disabled:n.disabled}]),"data-vss-custom-attr":o.customAttrs[a]?o.customAttrs[a]:"",onClick:x(O=>o.selectItem(n),["stop"]),onMousedown:e[9]||(e[9]=(...O)=>o.mousedownItem&&o.mousedownItem(...O)),onMouseenter:O=>o.pointerSet(a)},[P(t.$slots,"default",{option:n,idx:a},()=>[S(_(n.text),1)])],42,Z))),128))],38)],34)}const et=Q(X,[["render",tt]]);const st={class:"row"},ot={class:"col-12"},nt={class:"card m-b-30"},rt={class:"card-header"},at=s("h4",{class:"ml-4"},"Add Players",-1),it={class:"mb-0"},lt={class:"card-header-right"},dt={class:"card-body"},ct={key:0,class:"col-md-12 text-right"},ut=["onClick"],pt={class:"col-md-6"},ht={class:"form-group"},mt=s("label",{class:"col-form-label"},"Name",-1),_t={class:"col-md-6"},ft={class:"form-group"},yt=s("label",{class:"col-form-label"},"Status",-1),bt=["onUpdate:modelValue"],vt=s("option",{value:"Primary"},"Primary",-1),xt=s("option",{value:"Guest"},"Guest",-1),Ot=[vt,xt],gt={class:"col-md-12"},wt={class:"table table-xs"},It=s("th",{class:"p0-th"},"Gender",-1),Tt={style:{width:"65% !important"},class:"p0-th"},St=s("th",{class:"p0-th"},"Birth Date",-1),Vt={style:{width:"65% !important"},class:"p0-th"},kt=s("th",{class:"p0-th"},"Parent Name",-1),$t={style:{width:"65% !important"},class:"p0-th"},At=s("th",{class:"p0-th"},"Parent Email",-1),Ct={style:{width:"65% !important"},class:"p0-th"},Ft=s("th",{class:"p0-th"},"Status",-1),Mt={style:{width:"65% !important"},class:"p0-th"},Pt={key:0,class:"badge badge-success"},Et={key:1,class:"badge badge-info"},jt=s("i",{class:"fas fa-plus"},null,-1),Bt={class:"row"},Dt={class:"col-md-12 text-right"},Nt=["disabled","onClick"],Lt={__name:"Add",props:{players:{type:Object,required:!0},team:{type:Object,required:!0},errors:{type:Object,required:!1}},setup(t){const e=t,d=j();let y=w({}),c=w({});const o=i=>a.playerForms.filter(r=>r.id===i).length>1,n=(i,l)=>{setTimeout(()=>{if(l.id&&o(l.id)){d.error("Player already added.",{position:"bottom-left"}),l.id="";return}const r=a.playerForms[i].id,u=e.players.find(p=>p.id===r);l.gender=u.gender,l.birth_date=u.birth_date,l.parent_name=u.user.first_name+" "+u.user.last_name,l.parent_email=u.guardian.user.email},10)},a=B({playerForms:[]}),O=e.players.map(i=>({value:i.id,text:i.user.name})),$=w({id:"",status:"Primary"});D(()=>{a.playerForms.push($.value)});const A=i=>!!c[i],C=i=>{a.playerForms.splice(i,1)},F=()=>{a.playerForms.push({id:"",status:"Primary"})},M=()=>{a.post(route("club.teams.players.store",e.team.id),{onFinish:i=>{},onError:i=>{d.error("Validation Error: Please check your input and try again.",{position:"bottom-left"});let l=i;for(let r in l)l.hasOwnProperty(r)&&(y[r]=l[r][0],c[r]=!0)}})};return(i,l)=>(m(),N(K,{title:"Camps"},{default:I(()=>[s("div",st,[s("div",ot,[s("div",nt,[s("div",rt,[at,s("p",it,_(t.team.name),1),s("div",lt,[T(H,{backToListRoute:i.route("club.teams.players.index",t.team.id),class:"btn btn-primary"},null,8,["backToListRoute"])])]),s("div",dt,[(m(!0),f(V,null,k(v(a).playerForms,(r,u)=>(m(),f("div",{class:"row add-team-box mt-5",key:u},[v(a).playerForms.length>1?(m(),f("div",ct,[s("button",{class:"btn btn-danger",onClick:p=>C(u)},"X",8,ut)])):G("",!0),s("div",pt,[s("div",ht,[mt,T(v(et),{options:v(O),modelValue:r.id,"onUpdate:modelValue":p=>r.id=p,isError:A(`playerForms.${u}.id`),placeholder:"Select player",onBlur:p=>n(u,r)},{default:I(({option:p})=>[s("span",null,_(p.text),1)]),_:2},1032,["options","modelValue","onUpdate:modelValue","isError","onBlur"])])]),s("div",_t,[s("div",ft,[yt,R(s("select",{class:"custom-select","onUpdate:modelValue":p=>r.status=p},Ot,8,bt),[[U,r.status]])])]),s("div",gt,[s("table",wt,[s("tr",null,[It,s("td",Tt,_(r.gender),1)]),s("tr",null,[St,s("td",Vt,_(r.birth_date),1)]),s("tr",null,[kt,s("td",$t,_(r.parent_name),1)]),s("tr",null,[At,s("td",Ct,_(r.parent_email),1)]),s("tr",null,[Ft,s("td",Mt,[r.status==="Primary"?(m(),f("span",Pt,"Primary")):(m(),f("span",Et,"Guest"))])])])])]))),128)),s("div",{class:"row mt-3"},[s("div",{class:"col-md-12",style:{"padding-left":"0 !important"}},[s("button",{type:"button",class:"btn btn-info",onClick:F},[jt,S(" Add another player")])])]),s("div",Bt,[s("div",Dt,[T(v(q),{href:i.route("club.teams.index"),class:"btn btn-secondary mr-1"},{default:I(()=>[S(" Cancel ")]),_:1},8,["href"]),s("button",{type:"button",class:"btn btn-success",disabled:v(a).processing,onClick:x(M,["prevent"])},"Submit",8,Nt)])])])])])])]),_:1}))}};export{Lt as default};
