import{o as p,e as m,a as s,k as O,H as v,t as y,n as w,F as A,i as C,r as B,f as V,O as D,P as N,d as I,T as H,M as G,s as R,c as $,w as T,j as k,b as S,x as U,u as x,p as q,A as K,l as L}from"./app-d1115d7c.js";import z from"./AppLayout-02ff6c6d.js";import"./Banner-95ea4352.js";import"./Sidebar-340361d0.js";import"./Header-e1301bb1.js";import"./DropdownLink-c65e5ef3.js";const h={openOptions(e){e.$refs.input.focus(),e.showMenu=!0,e.mousedownState=!1},blurInput(e){e.mousedownState||(e.searchText="",e.closeOptions()),e.$emit("blur")},closeOptions(e){e.$refs.input.blur(),e.showMenu=!1},prevItem(e){const t=e.pointer-1,l=e.$el.offsetHeight*t;t>=0&&(e.pointer=t),e.$refs.menu.scrollTop=l},nextItem(e){const t=e.pointer+1,l=e.$el.offsetHeight*t;t<=e.filteredOptions.length-1&&(e.pointer=t);const _=e.$refs.menu.offsetHeight,c=Math.ceil((e.$refs.menu.scrollTop+e.$el.offsetHeight)/_),o=Math.ceil(l/_);c!==o&&(e.$refs.menu.scrollTop=(o-1)*e.$refs.menu.offsetHeight)},enterItem(e){const t=e.filteredOptions[e.pointer],l=t.disabled;t&&!l&&e.selectItem(t)},pointerSet(e,t){e.pointer=t},pointerAdjust(e){e.pointer>=e.filteredOptions.length-1&&(e.pointer=e.filteredOptions.length?e.filteredOptions.length-1:0)},mousedownItem(e){e.mousedownState=!0}};function X(e){return new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i")}const J={props:{id:{default:null},name:{type:String,default:""},isError:{type:Boolean,default:!1},customAttr:{type:Function,default:()=>""},isDisabled:{type:Boolean,default:!1},placeholder:{type:String,default:""},filterPredicate:{type:Function,default:(e,t)=>e.match(X(t))}}},Q=(e,t)=>{const l=e.__vccOpts||e;for(const[_,c]of t)l[_]=c;return l},W={name:"ModelSelect",mixins:[J],emits:["blur","searchchange","update:modelValue"],props:{modelValue:{type:[String,Number,Object,Boolean]},customAttr:{type:Function,default:()=>""},options:{type:Array}},data(){return{showMenu:!1,searchText:"",mousedownState:!1,pointer:-1}},watch:{value(e){this.pointer=this.filteredOptions.findIndex(t=>t.value===this.optionValue(e))},filteredOptions(){this.pointerAdjust()},searchText(){this.$emit("searchchange",this.searchText)}},computed:{searchTextCustomAttr(){return this.selectedOption&&this.selectedOption.value?this.customAttr(this.selectedOption):""},inputText(){if(this.searchText)return"";{let e=this.placeholder;return this.selectedOption&&(e=this.selectedOption.text),e}},customAttrs(){try{if(Array.isArray(this.options))return this.options.map(e=>this.customAttr(e))}catch{}return[]},textClass(){return!this.selectedOption&&this.placeholder?"default":""},menuClass(){return{visible:this.showMenu,hidden:!this.showMenu}},menuStyle(){return{display:this.showMenu?"block":"none"}},filteredOptions(){return this.searchText?this.options.filter(e=>{try{return this.filterPredicate(e.text,this.searchText)}catch{return!0}}):this.options},selectedOption(){return this.options.find(e=>e.value===this.optionValue(this.modelValue))}},methods:{deleteTextOrItem(){!this.searchText&&this.modelValue&&(this.selectItem({}),this.openOptions())},openOptions(){h.openOptions(this)},blurInput(){h.blurInput(this)},closeOptions(){h.closeOptions(this)},prevItem(){h.prevItem(this)},nextItem(){h.nextItem(this)},enterItem(){h.enterItem(this)},pointerSet(e){h.pointerSet(this,e)},pointerAdjust(){h.pointerAdjust(this)},mousedownItem(){h.mousedownItem(this)},selectItem(e){this.searchText="",this.closeOptions(),typeof this.modelValue=="object"&&this.modelValue?this.$emit("update:modelValue",e):(this.$emit("update:modelValue",e.value),e.value!==void 0&&e.value===e.text&&(this.searchText=e.value))},optionValue(e){return typeof e=="object"&&e!==null?e.value:e}}},Y=s("i",{class:"dropdown icon"},null,-1),Z=["disabled","tabindex","id","name","value"],ee=["data-vss-custom-attr"],te=["data-vss-custom-attr","onClick","onMouseenter"];function se(e,t,l,_,c,o){return p(),m("div",{class:w(["ui fluid search selection dropdown",{"active visible":c.showMenu,error:e.isError,disabled:e.isDisabled}]),onClick:t[11]||(t[11]=(...n)=>o.openOptions&&o.openOptions(...n)),onFocus:t[12]||(t[12]=(...n)=>o.openOptions&&o.openOptions(...n))},[Y,s("input",{class:"search",autocomplete:"off",disabled:e.isDisabled,tabindex:e.isDisabled?-1:0,id:e.id,name:e.name,value:c.searchText,onInput:t[0]||(t[0]=n=>c.searchText=n.target.value),ref:"input",onFocus:t[1]||(t[1]=O((...n)=>o.openOptions&&o.openOptions(...n),["prevent"])),onKeyup:[t[2]||(t[2]=v((...n)=>o.closeOptions&&o.closeOptions(...n),["esc"])),t[7]||(t[7]=v(O((...n)=>o.enterItem&&o.enterItem(...n),["prevent"]),["enter"]))],onBlur:t[3]||(t[3]=(...n)=>o.blurInput&&o.blurInput(...n)),onKeydown:[t[4]||(t[4]=v((...n)=>o.prevItem&&o.prevItem(...n),["up"])),t[5]||(t[5]=v((...n)=>o.nextItem&&o.nextItem(...n),["down"])),t[6]||(t[6]=v(O(()=>{},["prevent"]),["enter"])),t[8]||(t[8]=v((...n)=>o.deleteTextOrItem&&o.deleteTextOrItem(...n),["delete"]))]},null,40,Z),s("div",{class:w(["text",o.textClass]),"data-vss-custom-attr":o.searchTextCustomAttr},y(o.inputText),11,ee),s("div",{class:w(["menu",o.menuClass]),ref:"menu",onMousedown:t[10]||(t[10]=O(()=>{},["prevent"])),style:D(o.menuStyle),tabindex:"-1"},[(p(!0),m(A,null,C(o.filteredOptions,(n,a)=>(p(),m("div",{key:a,class:w(["item",{selected:n.selected||c.pointer===a,disabled:n.disabled}]),"data-vss-custom-attr":o.customAttrs[a]?o.customAttrs[a]:"",onClick:O(g=>o.selectItem(n),["stop"]),onMousedown:t[9]||(t[9]=(...g)=>o.mousedownItem&&o.mousedownItem(...g)),onMouseenter:g=>o.pointerSet(a)},[B(e.$slots,"default",{option:n,idx:a},()=>[V(y(n.text),1)])],42,te))),128))],38)],34)}const oe=Q(W,[["render",se]]);const ne={class:"row"},re={class:"col-12"},ae={class:"card m-b-30"},ie={class:"card-header"},le=s("h4",{class:"ml-4"},"Add Players",-1),ce={class:"mb-0"},de={class:"card-header-right"},ue={class:"card-body"},pe={key:0,class:"col-md-12 text-right"},he=["onClick"],me={class:"col-md-6"},_e={class:"form-group"},fe=s("label",{class:"col-form-label"},"Name",-1),ye={class:"col-md-6"},be={class:"form-group"},ve=s("label",{class:"col-form-label"},"Status",-1),xe=["onUpdate:modelValue"],Oe=s("option",{value:"Primary"},"Primary",-1),ge=s("option",{value:"Guest"},"Guest",-1),we=[Oe,ge],Ie={class:"col-md-12"},Te={class:"table table-xs"},Se=s("th",{class:"p0-th"},"Gender",-1),Ve={style:{width:"65% !important"},class:"p0-th"},$e=s("th",{class:"p0-th"},"Parent Name",-1),ke={style:{width:"65% !important"},class:"p0-th"},Ae=s("th",{class:"p0-th"},"Parent Email",-1),Ce={style:{width:"65% !important"},class:"p0-th"},Fe=s("th",{class:"p0-th"},"Status",-1),Me={style:{width:"65% !important"},class:"p0-th"},Pe={key:0,class:"badge badge-success"},Ee={key:1,class:"badge badge-info"},je=s("i",{class:"fas fa-plus"},null,-1),Be={class:"row"},De={class:"col-md-12 text-right"},Ne=["disabled","onClick"],Le={__name:"Add",props:{players:{type:Object,required:!0},team:{type:Object,required:!0},errors:{type:Object,required:!1}},setup(e){const t=e,l=N();let _=I({}),c=I({});const o=r=>a.playerForms.filter(u=>u.id===r).length>1,n=(r,d)=>{setTimeout(()=>{if(o(d.id)){l.error("Player already added.",{position:"bottom-left"}),d.id="";return}const u=a.playerForms[r].id,i=t.players.find(b=>b.id===u);d.gender=i.gender,d.parent_name=i.user.first_name+" "+i.user.last_name,d.parent_email=i.guardian.user.email},10)},a=H({playerForms:[]}),g=t.players.map(r=>({value:r.id,text:r.user.name})),F=I({id:"",status:"Primary"});G(()=>{a.playerForms.push(F.value)});const M=r=>!!c[r],P=r=>{a.playerForms.splice(r,1)},E=()=>{a.playerForms.push({id:"",status:"Primary"})},j=()=>{a.post(route("club.teams.players.store",t.team.id),{onFinish:r=>{},onError:r=>{l.error("Validation Error: Please check your input and try again.",{position:"bottom-left"});let d=r;for(let u in d)d.hasOwnProperty(u)&&(_[u]=d[u][0],c[u]=!0)}})};return(r,d)=>{const u=R("SuccessAlert");return p(),$(z,{title:"Camps"},{default:T(()=>[r.$page.props.flash.success?(p(),$(u,{key:0,message:r.$page.props.flash.success},null,8,["message"])):k("",!0),s("div",ne,[s("div",re,[s("div",ae,[s("div",ie,[le,s("p",ce,y(e.team.name),1),s("div",de,[S(U,{backToListRoute:r.route("club.teams.players.index",e.team.id),class:"btn btn-primary"},null,8,["backToListRoute"])])]),s("div",ue,[(p(!0),m(A,null,C(x(a).playerForms,(i,b)=>(p(),m("div",{class:"row add-team-box mt-5",key:b},[x(a).playerForms.length>1?(p(),m("div",pe,[s("button",{class:"btn btn-danger",onClick:f=>P(b)},"X",8,he)])):k("",!0),s("div",me,[s("div",_e,[fe,S(x(oe),{options:x(g),modelValue:i.id,"onUpdate:modelValue":f=>i.id=f,isError:M(`playerForms.${b}.id`),placeholder:"Select player",onBlur:f=>n(b,i)},{default:T(({option:f})=>[s("span",null,y(f.text),1)]),_:2},1032,["options","modelValue","onUpdate:modelValue","isError","onBlur"])])]),s("div",ye,[s("div",be,[ve,q(s("select",{class:"custom-select","onUpdate:modelValue":f=>i.status=f},we,8,xe),[[K,i.status]])])]),s("div",Ie,[s("table",Te,[s("tr",null,[Se,s("td",Ve,y(i.gender),1)]),s("tr",null,[$e,s("td",ke,y(i.parent_name),1)]),s("tr",null,[Ae,s("td",Ce,y(i.parent_email),1)]),s("tr",null,[Fe,s("td",Me,[i.status==="Primary"?(p(),m("span",Pe,"Primary")):(p(),m("span",Ee,"Guest"))])])])])]))),128)),s("div",{class:"row mt-3"},[s("div",{class:"col-md-12",style:{"padding-left":"0 !important"}},[s("button",{type:"button",class:"btn btn-info",onClick:E},[je,V(" Add another player")])])]),s("div",Be,[s("div",De,[S(x(L),{href:r.route("club.teams.index"),class:"btn btn-secondary mr-1"},{default:T(()=>[V(" Cancel ")]),_:1},8,["href"]),s("button",{type:"button",class:"btn btn-success",disabled:x(a).processing,onClick:O(j,["prevent"])},"Submit",8,Ne)])])])])])])]),_:1})}}};export{Le as default};
